<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <title>Life Garden | „É©„Ç§„Éï„Ç≤„Éº„É†ËÇ≤Êàê„Éë„Ç∫„É´</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="description" content="„Ç∑„É≥„Éó„É´„ÅßÁæé„Åó„ÅÑ„ÄÅ„Éñ„É©„Ç¶„Ç∂„ÅßÈÅä„Åπ„Çã„É©„Ç§„Éï„Ç≤„Éº„É†„ÄÇ„Éë„Çø„Éº„É≥„ÇíËÇ≤„Å¶„Å¶„ÄÅ„Ç∑„Çß„Ç¢„Åó„Çà„ÅÜ„ÄÇ">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;600&display=swap" rel="stylesheet">

  <!-- AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6799951658165737"
    crossorigin="anonymous"></script>

  <style>
    :root {
      --bg-color: #0a0a0f;
      --primary-color: #b249f8;
      /* Neon Purple */
      --secondary-color: #49f8f8;
      /* Neon Cyan */
      --text-color: #ffffff;
      --glass-bg: rgba(20, 20, 30, 0.7);
      --glass-border: rgba(255, 255, 255, 0.1);
    }

    * {
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      /* Prevent scrolling */
      font-family: 'Outfit', sans-serif;
      background-color: var(--bg-color);
      color: var(--text-color);
      width: 100vw;
      height: 100vh;
    }

    #game-canvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
      cursor: crosshair;
    }

    /* UI Overlay */
    #ui-layer {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 10;
      pointer-events: none;
      /* Let clicks pass through to canvas by default */
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      transition: opacity 0.5s ease;
    }

    .title-card {
      background: var(--glass-bg);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      padding: 3rem 4rem;
      border-radius: 24px;
      border: 1px solid var(--glass-border);
      text-align: center;
      pointer-events: auto;
      /* Re-enable clicks for the card */
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
      animation: fadeIn 1s ease-out;
    }

    h1 {
      font-size: 4rem;
      margin: 0;
      background: linear-gradient(135deg, #fff 0%, var(--primary-color) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 0 20px rgba(178, 73, 248, 0.5);
      letter-spacing: -0.02em;
    }

    p.subtitle {
      font-size: 1.2rem;
      color: rgba(255, 255, 255, 0.8);
      margin-top: 0.5rem;
      margin-bottom: 2.5rem;
    }

    .btn-start {
      background: linear-gradient(135deg, var(--primary-color), #7c24cc);
      color: white;
      border: none;
      padding: 1rem 3rem;
      font-size: 1.5rem;
      font-weight: 600;
      border-radius: 999px;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
      box-shadow: 0 0 15px rgba(178, 73, 248, 0.4);
      font-family: 'Outfit', sans-serif;
    }

    .btn-start:hover {
      transform: scale(1.05);
      box-shadow: 0 0 25px rgba(178, 73, 248, 0.6);
    }

    .btn-start:active {
      transform: scale(0.98);
    }

    .footer-note {
      margin-top: 1.5rem;
      font-size: 0.8rem;
      opacity: 0.6;
    }

    .footer-note a {
      color: var(--secondary-color);
      text-decoration: none;
    }

    /* HUD (Heads-up Display) shown during game */
    #hud {
      position: fixed;
      top: 20px;
      left: 20px;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.5s;
    }

    .hud-item {
      background: rgba(0, 0, 0, 0.6);
      padding: 0.5rem 1rem;
      border-radius: 8px;
      margin-bottom: 0.5rem;
      border-left: 3px solid var(--primary-color);
      font-size: 0.9rem;
      font-weight: 600;
      backdrop-filter: blur(4px);
    }

    /* Controls */
    #controls {
      position: fixed;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 1rem;
      opacity: 0;
      transition: opacity 0.5s;
      pointer-events: auto;
      z-index: 20;
    }

    .icon-btn {
      background: rgba(30, 30, 35, 0.9);
      border: 1px solid var(--glass-border);
      color: #fff;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      font-size: 1.2rem;
      backdrop-filter: blur(5px);
      transition: all 0.2s;
    }

    .icon-btn:hover {
      background: var(--primary-color);
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Mobile Adjustments */
    @media (max-width: 600px) {
      h1 {
        font-size: 2.5rem;
      }

      .title-card {
        padding: 2rem;
        width: 90%;
      }
    }
  </style>
</head>

<body>

  <canvas id="game-canvas"></canvas>

  <!-- Overlay Screen (Welcome) -->
  <div id="ui-layer">
    <div class="title-card">
      <h1>Life Garden</h1>
      <p class="subtitle">„Ç∑„É≥„Éó„É´„ÅßÁæé„Åó„ÅÑ„ÄÅÁîüÂëΩ„ÅÆ„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥</p>
      <button class="btn-start" onclick="startGame()">Start</button>
      <div class="footer-note">
        Based on Conway's Game of Life | <a href="privacy.html">Privacy</a>
      </div>
    </div>
  </div>

  <!-- Gameplay HUD -->
  <div id="hud">
    <div class="hud-item" id="generation-display">GEN: 0</div>
    <div class="hud-item" id="population-display">POP: 0</div>
  </div>

  <!-- Controls -->
  <div id="controls">
    <button class="icon-btn" onclick="togglePause()" title="Play/Pause">‚èØ</button>
    <button class="icon-btn" onclick="randomizeBoard()" title="Randomize">üé≤</button>
    <button class="icon-btn" onclick="clearBoard()" title="Clear">üóë</button>
    <button class="icon-btn" onclick="captureSnapshot()" title="Share">üì∑</button>
  </div>

  <script>
    /**
     * Life Garden Core (Embedded)
     */
    const canvas = document.getElementById('game-canvas');
    const ctx = canvas.getContext('2d');

    // Colors
    const COLOR_BG = '#0a0a0f';
    const COLOR_CELL = '#b249f8';
    const COLOR_CELL_YOUNG = '#49f8f8';

    let cols, rows;
    let resolution = 20; // Cell size
    let grid = [];
    let nextGrid = [];

    let isPlaying = false; // Is the game simulation running?
    let isGameMode = false; // Has the user clicked Start?
    let animationId;
    let generation = 0;

    // Mouse interaction
    let isDragging = false;

    // Initialize
    function init() {
      resize();
      createGrid();
      // Start with a random pattern for the background
      randomize(0.15); // 15% density
      render();

      // Start animation loop immediately for the background effect
      loop();
    }

    function resize() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      // Determine resolution based on device
      resolution = window.innerWidth < 600 ? 15 : 20;
      cols = Math.ceil(canvas.width / resolution);
      rows = Math.ceil(canvas.height / resolution);
    }

    function createGrid() {
      grid = new Array(cols).fill(null).map(() => new Array(rows).fill(0));
      nextGrid = new Array(cols).fill(null).map(() => new Array(rows).fill(0));
    }

    function randomize(density = 0.5) {
      for (let i = 0; i < cols; i++) {
        for (let j = 0; j < rows; j++) {
          grid[i][j] = Math.random() < density ? 1 : 0;
        }
      }
      generation = 0;
      updateHud();
    }

    function clearBoard() {
      for (let i = 0; i < cols; i++) {
        for (let j = 0; j < rows; j++) {
          grid[i][j] = 0;
        }
      }
      generation = 0;
      updateHud();
      render();
    }

    function update() {
      let activeCells = 0;

      for (let i = 0; i < cols; i++) {
        for (let j = 0; j < rows; j++) {
          let state = grid[i][j];
          let neighbors = countNeighbors(grid, i, j);

          if (state === 0 && neighbors === 3) {
            nextGrid[i][j] = 1;
          } else if (state === 1 && (neighbors < 2 || neighbors > 3)) {
            nextGrid[i][j] = 0;
          } else {
            nextGrid[i][j] = state;
          }

          if (nextGrid[i][j] === 1) activeCells++;
        }
      }

      // Swap grids
      [grid, nextGrid] = [nextGrid, grid];
      generation++;
      updateHud(activeCells);
    }

    function countNeighbors(grid, x, y) {
      let sum = 0;
      for (let i = -1; i < 2; i++) {
        for (let j = -1; j < 2; j++) {
          let col = (x + i + cols) % cols;
          let row = (y + j + rows) % rows;
          sum += grid[col][row];
        }
      }
      sum -= grid[x][y];
      return sum;
    }

    function render() {
      // Fade effect instead of clearRect for "tails" (optional, kept simple for now)
      ctx.fillStyle = COLOR_BG;
      ctx.fillRect(0, 0, canvas.width, canvas.height); // Clear screen

      // Draw cells
      ctx.shadowBlur = 10;
      ctx.shadowColor = COLOR_CELL;

      for (let i = 0; i < cols; i++) {
        for (let j = 0; j < rows; j++) {
          if (grid[i][j] === 1) {
            let x = i * resolution;
            let y = j * resolution;

            // Round rect for nicer look
            ctx.fillStyle = COLOR_CELL;
            ctx.beginPath();
            ctx.roundRect(x + 1, y + 1, resolution - 2, resolution - 2, 4);
            ctx.fill();
          }
        }
      }
      ctx.shadowBlur = 0;
    }

    function loop() {
      // If we are in "Title Screen" mode, update slowly but render always
      // If in "Game Mode", update based on isPlaying

      if (!isGameMode) {
        // Background animation: update every 5 frames to be chill
        if (Date.now() % 100 < 20) {
          update();
        }
      } else {
        if (isPlaying) {
          update();
        }
      }

      render();
      animationId = requestAnimationFrame(loop);
    }

    // --- Interaction ---

    function startGame() {
      isGameMode = true;
      isPlaying = true;

      // Hide Title UI
      document.getElementById('ui-layer').style.opacity = '0';
      setTimeout(() => {
        document.getElementById('ui-layer').style.display = 'none';
      }, 500);

      // Show HUD & Controls
      document.getElementById('hud').style.opacity = '1';
      document.getElementById('controls').style.opacity = '1';

      // Clear the chaotic background and give user a fresh start or keep it?
      // Let's keep it but maybe pause it or let them play with it.
      // Actually, clearing it gives a fresh canvas.
      clearBoard();

      // Helpful little starter pattern in center
      let cx = Math.floor(cols / 2);
      let cy = Math.floor(rows / 2);
      grid[cx][cy] = 1;
      grid[cx][cy - 1] = 1;
      grid[cx][cy + 1] = 1;
    }

    function togglePause() {
      isPlaying = !isPlaying;
      const btn = document.querySelector('#controls button:first-child');
      btn.innerText = isPlaying ? '‚è∏' : '‚ñ∂';
    }

    function randomizeBoard() {
      randomize();
    }

    function captureSnapshot() {
      // Simple pause before capture
      let wasPlaying = isPlaying;
      isPlaying = false;

      // Render one last time without clearing to ensure it's there? No, just draw.
      render();

      // Create image
      const dataUrl = canvas.toDataURL('image/png');

      // Open in new tab or download
      // Ideally we'd have a nice modal. For now, simple link.
      const link = document.createElement('a');
      link.download = `life-garden-${Date.now()}.png`;
      link.href = dataUrl;
      link.click();

      if (wasPlaying) isPlaying = true;
    }

    function updateHud(pop = 0) {
      document.getElementById('generation-display').innerText = `GEN: ${generation}`;
      document.getElementById('population-display').innerText = `POP: ${pop}`;
    }

    // Input handling
    function handleInput(e) {
      // Calculate grid coords
      const rect = canvas.getBoundingClientRect();
      const x = e.clientX || e.touches[0].clientX;
      const y = e.clientY || e.touches[0].clientY;

      const i = Math.floor((x - rect.left) / resolution);
      const j = Math.floor((y - rect.top) / resolution);

      if (i >= 0 && i < cols && j >= 0 && j < rows) {
        grid[i][j] = 1; // Draw mode only for now
        render();
      }
    }

    window.addEventListener('resize', () => {
      resize();
      createGrid(); // Note: this clears grid. Ideally we'd map old to new.
      randomize(0.1);
    });

    // Mouse Events
    canvas.addEventListener('mousedown', (e) => {
      isDragging = true;
      handleInput(e);
    });
    window.addEventListener('mouseup', () => {
      isDragging = false;
    });
    canvas.addEventListener('mousemove', (e) => {
      if (isDragging) handleInput(e);
    });

    // Touch Events
    canvas.addEventListener('touchstart', (e) => {
      isDragging = true;
      handleInput(e);
      e.preventDefault(); // enable swap
    }, { passive: false });
    canvas.addEventListener('touchend', () => isDragging = false);
    canvas.addEventListener('touchmove', (e) => {
      if (isDragging) handleInput(e);
      e.preventDefault();
    }, { passive: false });

    // Shortcuts
    window.addEventListener('keydown', (e) => {
      if (!isGameMode) return;
      if (e.code === 'Space') togglePause();
      if (e.code === 'KeyR') randomizeBoard();
      if (e.code === 'KeyC') clearBoard();
    });

    // Init
    init();

  </script>
</body>

</html>